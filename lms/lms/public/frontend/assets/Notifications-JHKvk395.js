import{d as m,r as H,aa as S,s as D,j as _,aA as $,k as w,x as s,y as c,C as o,H as r,I as e,A as f,B as l,M as k,K as B,L as z,J as p,av as E,a9 as L,N as R,aQ as F,aZ as I,ac as J}from"./frappe-ui-CfOnYHud.js";import{_ as K}from"./UserAvatar-NO3477wF.js";import{u as P,X as Q}from"./index-5_0ocoxz.js";const X={class:"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5"},Z={class:"flex items-center space-x-2"},q={class:"w-3/4 mx-auto px-5 pt-6 divide-y"},G={class:"flex items-center py-2 justify-between"},O={class:"flex items-center"},W=["innerHTML"],Y={class:"flex items-center space-x-2"},ee={key:1,class:"text-gray-600"},ne={__name:"Notifications",setup(ae){var h,x;const d=m("$user"),U=m("$socket"),V=m("$allUsers"),i=H("Unread"),j=S();D(()=>{d.data||j.push({name:"Courses"}),U.on("publish_lms_notifications",a=>{n.reload()})});const b=_(()=>i.value==="Unread"?n.data:u.data),n=$({doctype:"Notification Log",fields:["subject","from_user","link","read","name"],filters:{for_user:(h=d.data)==null?void 0:h.name,read:0},orderBy:"creation desc",auto:!0,cache:"Unread Notifications"}),u=$({doctype:"Notification Log",fields:["subject","from_user","link","read","name"],filters:{for_user:(x=d.data)==null?void 0:x.name,read:1},orderBy:"creation desc",auto:!0,cache:"Read Notifications"}),v=w({url:"lms.lms.api.mark_as_read",makeParams(a){return{name:a.name}},onSuccess(a){n.reload(),u.reload()}}),y=w({url:"lms.lms.api.mark_all_as_read",onSuccess(a){n.reload(),u.reload()}}),M=_(()=>[{label:"Notifications",route:{name:"Notifications"}}]),A=_(()=>({title:"Notifications",description:"All your notifications in one place."}));return P(A),(a,N)=>{var g,C;return s(),c(B,null,[o("header",X,[r(e(E),{items:M.value},null,8,["items"]),o("div",Z,[i.value==="Unread"&&((g=e(n).data)==null?void 0:g.length)>0?(s(),f(e(R),{key:0,onClick:e(y).submit,loading:e(y).loading},{default:l(()=>[L(p(a.__("Mark all as read")),1)]),_:1},8,["onClick","loading"])):k("",!0),r(e(F),{class:"inline-block",buttons:[{label:"Unread",active:!0},{label:"Read"}],modelValue:i.value,"onUpdate:modelValue":N[0]||(N[0]=t=>i.value=t)},null,8,["modelValue"])])]),o("div",q,[(C=b.value)!=null&&C.length?(s(!0),c(B,{key:0},z(b.value,t=>(s(),c("div",G,[o("div",O,[r(K,{user:e(V).data[t.from_user],class:"mr-2"},null,8,["user"]),o("div",{class:"notification",innerHTML:t.subject},null,8,W)]),o("div",Y,[t.link?(s(),f(e(I),{key:0,to:t.link,onClick:T=>e(v).submit({name:t.name}),class:"text-gray-600 font-medium text-sm hover:text-gray-700"},{default:l(()=>[L(p(a.__("View")),1)]),_:2},1032,["to","onClick"])):k("",!0),r(e(J),{text:a.__("Mark as read")},{default:l(()=>[t.read?k("",!0):(s(),f(e(R),{key:0,variant:"ghost",onClick:T=>e(v).submit({name:t.name})},{icon:l(()=>[r(e(Q),{class:"h-4 w-4 text-gray-700 stroke-1.5"})]),_:2},1032,["onClick"]))]),_:2},1032,["text"])])]))),256)):(s(),c("div",ee,p(a.__("Nothing to see here.")),1))])],64)}}};export{ne as default};
//# sourceMappingURL=Notifications-JHKvk395.js.map
