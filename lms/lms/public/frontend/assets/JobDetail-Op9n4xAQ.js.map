{"version":3,"file":"JobDetail-Op9n4xAQ.js","sources":["../../../../frontend/src/components/Modals/JobApplicationModal.vue","../../../../frontend/src/pages/JobDetail.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\tv-model=\"show\"\n\t\tclass=\"text-base\"\n\t\t:options=\"{\n\t\t\ttitle: __('Apply for this job'),\n\t\t\tsize: 'lg',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Submit',\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick: (close) => {\n\t\t\t\t\t\tsubmitResume(close)\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t}\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div class=\"flex flex-col gap-4\">\n\t\t\t\t<p>\n\t\t\t\t\t{{\n\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t'Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.'\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t</p>\n\t\t\t\t<div v-if=\"!resume\">\n\t\t\t\t\t<FileUploader\n\t\t\t\t\t\t:fileTypes=\"['.pdf']\"\n\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t@success=\"\n\t\t\t\t\t\t\t(file) => {\n\t\t\t\t\t\t\t\tresume = file\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ file, progress, uploading, openFileSelector }\">\n\t\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tuploading ? `Uploading ${progress}%` : 'Upload your resume'\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</FileUploader>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"flex items-center\">\n\t\t\t\t\t<div class=\"border rounded-md p-2 mr-2\">\n\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5 text-gray-700\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"flex flex-col\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ resume.file_name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"text-sm text-gray-500 mt-1\">\n\t\t\t\t\t\t\t{{ getFileSize(resume.file_size) }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport { Dialog, FileUploader, Button, createResource } from 'frappe-ui'\nimport { FileText } from 'lucide-vue-next'\nimport { ref, inject, defineModel } from 'vue'\nimport { createToast, getFileSize } from '@/utils/'\n\nconst resume = ref(null)\nconst show = defineModel()\nconst user = inject('$user')\nconst application = defineModel('application')\n\nconst props = defineProps({\n\tjob: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (extension != 'pdf') {\n\t\treturn 'Only PDF file is allowed'\n\t}\n}\n\nconst jobApplication = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'LMS Job Application',\n\t\t\t\tuser: user.data?.name,\n\t\t\t\tresume: resume.value?.file_name,\n\t\t\t\tjob: props.job,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst submitResume = (close) => {\n\tjobApplication.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\tif (!resume.value) {\n\t\t\t\t\treturn 'Please upload your resume'\n\t\t\t\t}\n\t\t\t},\n\t\t\tonSuccess() {\n\t\t\t\tcreateToast({\n\t\t\t\t\ttitle: 'Success',\n\t\t\t\t\ttext: 'Your application has been submitted',\n\t\t\t\t\ticon: 'check',\n\t\t\t\t\ticonClasses: 'bg-green-600 text-white rounded-md p-px',\n\t\t\t\t})\n\t\t\t\tapplication.value.reload()\n\t\t\t\tclose()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tcreateToast({\n\t\t\t\t\ttitle: 'Error',\n\t\t\t\t\ttext: err.messages?.[0] || err,\n\t\t\t\t\ticon: 'x',\n\t\t\t\t\ticonClasses: 'bg-red-600 text-white rounded-md p-px',\n\t\t\t\t\tposition: 'top-center',\n\t\t\t\t\ttimeout: 10,\n\t\t\t\t})\n\t\t\t},\n\t\t}\n\t)\n}\n</script>\n","<template>\n\t<div class=\"\">\n\t\t<header\n\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5\"\n\t\t>\n\t\t\t<Breadcrumbs\n\t\t\t\tclass=\"h-7\"\n\t\t\t\t:items=\"[\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: __('Jobs'),\n\t\t\t\t\t\troute: { name: 'Jobs' },\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: job.data?.job_title,\n\t\t\t\t\t\troute: { name: 'JobDetail', params: { job: job.data?.name } },\n\t\t\t\t\t},\n\t\t\t\t]\"\n\t\t\t/>\n\t\t\t<div v-if=\"user.data?.name\" class=\"flex\">\n\t\t\t\t<router-link\n\t\t\t\t\tv-if=\"user.data.name == job.data?.owner\"\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'JobCreation',\n\t\t\t\t\t\tparams: { jobName: job.data?.name },\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<Button class=\"mr-2\">\n\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t<Pencil class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ __('Edit') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</router-link>\n\t\t\t\t<Button\n\t\t\t\t\tv-if=\"!jobApplication.data?.length\"\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t@click=\"openApplicationModal()\"\n\t\t\t\t>\n\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t<SendHorizonal class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t{{ __('Apply') }}\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t\t<div v-else>\n\t\t\t\t<Button @click=\"redirectToLogin(job.data?.name)\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{ __('Login to apply') }}\n\t\t\t\t\t</span>\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</header>\n\t\t<div v-if=\"job.data\" class=\"max-w-3xl mx-auto\">\n\t\t\t<div class=\"p-4\">\n\t\t\t\t<div class=\"flex mb-10\">\n\t\t\t\t\t<img\n\t\t\t\t\t\t:src=\"job.data.company_logo\"\n\t\t\t\t\t\tclass=\"w-16 h-16 rounded-lg object-contain mr-4\"\n\t\t\t\t\t\t:alt=\"job.data.company_name\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-2xl font-semibold mb-4\">\n\t\t\t\t\t\t\t{{ job.data.job_title }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-10 gap-y-2 md:gap-y-4\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t\t<Building2 class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t\t<span>{{ job.data.company_name }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t\t<MapPin class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t\t<span>{{ job.data.location }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t\t<ClipboardType class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t\t<span>{{ job.data.type }}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t\t\t\t\t<CalendarDays class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t{{ dayjs(job.data.creation).format('DD MMM YYYY') }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"applicationCount.data\"\n\t\t\t\t\t\t\t\tclass=\"flex items-center space-x-2\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<SquareUserRound class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t>{{ applicationCount.data }}\n\t\t\t\t\t\t\t\t\t{{ __('applications received') }}</span\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<p\n\t\t\t\t\tv-html=\"job.data.description\"\n\t\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100 prose-sm max-w-none !whitespace-normal mt-6\"\n\t\t\t\t></p>\n\t\t\t</div>\n\t\t\t<JobApplicationModal\n\t\t\t\tv-model=\"showApplicationModal\"\n\t\t\t\tv-model:application=\"jobApplication\"\n\t\t\t\t:job=\"job.data.name\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { Button, Breadcrumbs, createResource } from 'frappe-ui'\nimport { inject, ref, computed } from 'vue'\nimport { updateDocumentTitle } from '@/utils'\nimport JobApplicationModal from '@/components/Modals/JobApplicationModal.vue'\nimport {\n\tMapPin,\n\tSendHorizonal,\n\tPencil,\n\tBuilding2,\n\tCalendarDays,\n\tClipboardType,\n\tSquareUserRound,\n} from 'lucide-vue-next'\n\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst showApplicationModal = ref(false)\n\nconst props = defineProps({\n\tjob: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst job = createResource({\n\turl: 'lms.lms.api.get_job_details',\n\tparams: {\n\t\tjob: props.job,\n\t},\n\tcache: ['job', props.job],\n\tauto: true,\n\tonSuccess: (data) => {\n\t\tif (user.data?.name) {\n\t\t\tjobApplication.submit()\n\t\t}\n\t\tapplicationCount.submit()\n\t},\n})\n\nconst jobApplication = createResource({\n\turl: 'frappe.client.get_list',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'LMS Job Application',\n\t\t\tfilters: {\n\t\t\t\tjob: job.data?.name,\n\t\t\t\tuser: user.data?.name,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst applicationCount = createResource({\n\turl: 'frappe.client.get_count',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'LMS Job Application',\n\t\t\tfilters: {\n\t\t\t\tjob: job.data?.name,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst openApplicationModal = () => {\n\tshowApplicationModal.value = true\n}\n\nconst redirectToLogin = (job) => {\n\twindow.location.href = `/login?redirect-to=/job-openings/${job}`\n}\n\nconst pageMeta = computed(() => {\n\treturn {\n\t\ttitle: job.data?.job_title,\n\t\tdescription: job.data?.description,\n\t}\n})\n\nupdateDocumentTitle(pageMeta)\n</script>\n"],"names":["resume","ref","show","_useModel","user","inject","application","__props","props","validateFile","file","jobApplication","createResource","values","_a","_b","submitResume","close","createToast","err","dayjs","showApplicationModal","job","data","applicationCount","openApplicationModal","redirectToLogin","pageMeta","computed","updateDocumentTitle"],"mappings":"6sBAuEA,MAAMA,EAASC,EAAI,IAAI,EACjBC,EAAOC,gBAAY,EACnBC,EAAOC,EAAO,OAAO,EACrBC,EAAcH,EAAWI,EAAC,aAAa,EAEvCC,EAAQD,EAORE,EAAgBC,GAAS,CAE9B,GADgBA,EAAK,KAAK,MAAM,GAAG,EAAE,IAAK,EAAC,YAAa,GACvC,MAChB,MAAO,0BAET,EAEMC,EAAiBC,EAAe,CACrC,IAAK,uBACL,WAAWC,EAAQ,SAClB,MAAO,CACN,IAAK,CACJ,QAAS,sBACT,MAAMC,EAAAV,EAAK,OAAL,YAAAU,EAAW,KACjB,QAAQC,EAAAf,EAAO,QAAP,YAAAe,EAAc,UACtB,IAAKP,EAAM,GACX,CACD,CACD,CACF,CAAC,EAEKQ,EAAgBC,GAAU,CAC/BN,EAAe,OACd,CAAE,EACF,CACC,UAAW,CACV,GAAI,CAACX,EAAO,MACX,MAAO,2BAER,EACD,WAAY,CACXkB,EAAY,CACX,MAAO,UACP,KAAM,sCACN,KAAM,QACN,YAAa,yCAClB,CAAK,EACDZ,EAAY,MAAM,OAAQ,EAC1BW,EAAO,CACP,EACD,QAAQE,EAAK,OACZD,EAAY,CACX,MAAO,QACP,OAAMJ,EAAAK,EAAI,WAAJ,YAAAL,EAAe,KAAMK,EAC3B,KAAM,IACN,YAAa,wCACb,SAAU,aACV,QAAS,EACd,CAAK,CACD,CACD,CACD,CACF,kmDCTA,MAAMf,EAAOC,EAAO,OAAO,EACrBe,EAAQf,EAAO,QAAQ,EACvBgB,EAAuBpB,EAAI,EAAK,EAEhCO,EAAQD,EAORe,EAAMV,EAAe,CAC1B,IAAK,8BACL,OAAQ,CACP,IAAKJ,EAAM,GACX,EACD,MAAO,CAAC,MAAOA,EAAM,GAAG,EACxB,KAAM,GACN,UAAYe,GAAS,QAChBT,EAAAV,EAAK,OAAL,MAAAU,EAAW,MACdH,EAAe,OAAQ,EAExBa,EAAiB,OAAQ,CACzB,CACF,CAAC,EAEKb,EAAiBC,EAAe,CACrC,IAAK,yBACL,WAAWC,EAAQ,SAClB,MAAO,CACN,QAAS,sBACT,QAAS,CACR,KAAKC,EAAAQ,EAAI,OAAJ,YAAAR,EAAU,KACf,MAAMC,EAAAX,EAAK,OAAL,YAAAW,EAAW,IACjB,CACD,CACD,CACF,CAAC,EAEKS,EAAmBZ,EAAe,CACvC,IAAK,0BACL,WAAWC,EAAQ,OAClB,MAAO,CACN,QAAS,sBACT,QAAS,CACR,KAAKC,EAAAQ,EAAI,OAAJ,YAAAR,EAAU,IACf,CACD,CACD,CACF,CAAC,EAEKW,EAAuB,IAAM,CAClCJ,EAAqB,MAAQ,EAC9B,EAEMK,EAAmBJ,GAAQ,CAChC,OAAO,SAAS,KAAO,oCAAoCA,CAAG,EAC/D,EAEMK,EAAWC,EAAS,IAAM,SAC/B,MAAO,CACN,OAAOd,EAAAQ,EAAI,OAAJ,YAAAR,EAAU,UACjB,aAAaC,EAAAO,EAAI,OAAJ,YAAAP,EAAU,WACvB,CACF,CAAC,EAED,OAAAc,EAAoBF,CAAQ"}