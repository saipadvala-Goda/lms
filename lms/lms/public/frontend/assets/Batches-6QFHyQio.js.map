{"version":3,"file":"Batches-6QFHyQio.js","sources":["../../../../frontend/src/pages/Batches.vue"],"sourcesContent":["<template>\n\t<div class=\"\">\n\t\t<header\n\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5\"\n\t\t>\n\t\t\t<Breadcrumbs\n\t\t\t\tclass=\"h-7\"\n\t\t\t\t:items=\"[{ label: __('Batches'), route: { name: 'Batches' } }]\"\n\t\t\t/>\n\t\t\t<div class=\"flex space-x-2\">\n\t\t\t\t<div class=\"w-40\">\n\t\t\t\t\t<Select\n\t\t\t\t\t\tv-if=\"categories.data?.length\"\n\t\t\t\t\t\tv-model=\"currentCategory\"\n\t\t\t\t\t\t:options=\"categories.data\"\n\t\t\t\t\t\t:placeholder=\"__('Filter')\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<router-link\n\t\t\t\t\tv-if=\"user.data?.is_moderator\"\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'BatchForm',\n\t\t\t\t\t\tparams: { batchName: 'new' },\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<Button variant=\"solid\">\n\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t<Plus class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t{{ __('New Batch') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</router-link>\n\t\t\t</div>\n\t\t</header>\n\t\t<div v-if=\"batches.data\" class=\"pb-5\">\n\t\t\t<div\n\t\t\t\tv-if=\"batches.data.length == 0 && batches.list.loading\"\n\t\t\t\tclass=\"p-5 text-base text-gray-700\"\n\t\t\t>\n\t\t\t\t{{ __('Loading Batches...') }}\n\t\t\t</div>\n\t\t\t<Tabs\n\t\t\t\tv-model=\"tabIndex\"\n\t\t\t\t:tabs=\"makeTabs\"\n\t\t\t\ttablistClass=\"overflow-x-visible flex-wrap !gap-3 md:flex-nowrap\"\n\t\t\t>\n\t\t\t\t<template #tab=\"{ tab, selected }\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclass=\"group -mb-px flex items-center gap-2 border-b border-transparent py-2.5 text-base text-gray-600 duration-300 ease-in-out hover:border-gray-400 hover:text-gray-900\"\n\t\t\t\t\t\t\t:class=\"{ 'text-gray-900': selected }\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<component v-if=\"tab.icon\" :is=\"tab.icon\" class=\"h-5\" />\n\t\t\t\t\t\t\t{{ __(tab.label) }}\n\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t:class=\"\n\t\t\t\t\t\t\t\t\tselected\n\t\t\t\t\t\t\t\t\t\t? 'text-gray-800 border border-gray-800'\n\t\t\t\t\t\t\t\t\t\t: 'border border-gray-500'\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\tvariant=\"subtle\"\n\t\t\t\t\t\t\t\ttheme=\"gray\"\n\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{ tab.count }}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template #default=\"{ tab }\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"tab.batches && tab.batches.value.length\"\n\t\t\t\t\t\tclass=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 m-5\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<router-link\n\t\t\t\t\t\t\tv-for=\"batch in tab.batches.value\"\n\t\t\t\t\t\t\t:to=\"{ name: 'BatchDetail', params: { batchName: batch.name } }\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BatchCard :batch=\"batch\" />\n\t\t\t\t\t\t</router-link>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\tclass=\"grid flex-1 place-items-center text-xl font-medium text-gray-500\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"flex flex-col items-center justify-center mt-4\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ __('No {0} batches found').format(tab.label.toLowerCase()) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</Tabs>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tcreateListResource,\n\tcreateResource,\n\tBreadcrumbs,\n\tButton,\n\tTabs,\n\tBadge,\n\tSelect,\n} from 'frappe-ui'\nimport { Plus } from 'lucide-vue-next'\nimport BatchCard from '@/components/BatchCard.vue'\nimport { inject, ref, computed, onMounted, watch } from 'vue'\nimport { updateDocumentTitle } from '@/utils'\n\nconst user = inject('$user')\nconst currentCategory = ref(null)\n\nonMounted(() => {\n\tlet queries = new URLSearchParams(location.search)\n\tif (queries.has('category')) {\n\t\tcurrentCategory.value = queries.get('category')\n\t}\n})\n\nconst batches = createListResource({\n\tdoctype: 'LMS Batch',\n\turl: 'lms.lms.utils.get_batches',\n\tcache: ['batches', user?.data?.email],\n\tauto: true,\n})\n\nconst categories = createResource({\n\turl: 'lms.lms.api.get_categories',\n\tmakeParams() {\n\t\treturn {\n\t\t\tdoctype: 'LMS Batch',\n\t\t\tfilters: {\n\t\t\t\tpublished: 1,\n\t\t\t},\n\t\t}\n\t},\n\tcache: ['batchCategories'],\n\tauto: true,\n\ttransform(data) {\n\t\tdata.unshift({\n\t\t\tlabel: '',\n\t\t\tvalue: null,\n\t\t})\n\t},\n})\n\nconst tabIndex = ref(0)\nlet tabs\n\nconst makeTabs = computed(() => {\n\ttabs = []\n\taddToTabs('Upcoming')\n\n\tif (user.data?.is_moderator) {\n\t\taddToTabs('Archived')\n\t\taddToTabs('Private')\n\t}\n\n\tif (user.data) {\n\t\taddToTabs('Enrolled')\n\t}\n\n\treturn tabs\n})\n\nconst getBatches = (type) => {\n\tif (currentCategory.value && currentCategory.value != '') {\n\t\treturn batches.data[type].filter(\n\t\t\t(batch) => batch.category == currentCategory.value\n\t\t)\n\t}\n\treturn batches.data[type]\n}\n\nconst addToTabs = (label) => {\n\tlet batches = getBatches(label.toLowerCase().split(' ').join('_'))\n\ttabs.push({\n\t\tlabel,\n\t\tbatches: computed(() => batches),\n\t\tcount: computed(() => batches.length),\n\t})\n}\n\nwatch(\n\t() => currentCategory.value,\n\t() => {\n\t\tlet queries = new URLSearchParams(location.search)\n\t\tif (currentCategory.value) {\n\t\t\tqueries.set('category', currentCategory.value)\n\t\t} else {\n\t\t\tqueries.delete('category')\n\t\t}\n\t\thistory.pushState(null, '', `${location.pathname}?${queries.toString()}`)\n\t}\n)\n\nconst pageMeta = computed(() => {\n\treturn {\n\t\ttitle: 'Batches',\n\t\tdescription: 'All batches divided by categories',\n\t}\n})\n\nupdateDocumentTitle(pageMeta)\n</script>\n"],"names":["user","inject","currentCategory","ref","onMounted","queries","batches","createListResource","_a","categories","createResource","data","tabIndex","tabs","makeTabs","computed","addToTabs","getBatches","type","batch","label","watch","pageMeta","updateDocumentTitle"],"mappings":"uxFA+GA,MAAMA,EAAOC,EAAO,OAAO,EACrBC,EAAkBC,EAAI,IAAI,EAEhCC,EAAU,IAAM,CACf,IAAIC,EAAU,IAAI,gBAAgB,SAAS,MAAM,EAC7CA,EAAQ,IAAI,UAAU,IACzBH,EAAgB,MAAQG,EAAQ,IAAI,UAAU,EAEhD,CAAC,EAED,MAAMC,EAAUC,EAAmB,CAClC,QAAS,YACT,IAAK,4BACL,MAAO,CAAC,WAAWC,EAAAR,GAAA,YAAAA,EAAM,OAAN,YAAAQ,EAAY,KAAK,EACpC,KAAM,EACP,CAAC,EAEKC,EAAaC,EAAe,CACjC,IAAK,6BACL,YAAa,CACZ,MAAO,CACN,QAAS,YACT,QAAS,CACR,UAAW,CACX,CACD,CACD,EACD,MAAO,CAAC,iBAAiB,EACzB,KAAM,GACN,UAAUC,EAAM,CACfA,EAAK,QAAQ,CACZ,MAAO,GACP,MAAO,IACV,CAAG,CACD,CACF,CAAC,EAEKC,EAAWT,EAAI,CAAC,EACtB,IAAIU,EAEJ,MAAMC,EAAWC,EAAS,IAAM,OAC/B,OAAAF,EAAO,CAAE,EACTG,EAAU,UAAU,GAEhBR,EAAAR,EAAK,OAAL,MAAAQ,EAAW,eACdQ,EAAU,UAAU,EACpBA,EAAU,SAAS,GAGhBhB,EAAK,MACRgB,EAAU,UAAU,EAGdH,CACR,CAAC,EAEKI,EAAcC,GACfhB,EAAgB,OAASA,EAAgB,OAAS,GAC9CI,EAAQ,KAAKY,CAAI,EAAE,OACxBC,GAAUA,EAAM,UAAYjB,EAAgB,KAC7C,EAEKI,EAAQ,KAAKY,CAAI,EAGnBF,EAAaI,GAAU,CAC5B,IAAId,EAAUW,EAAWG,EAAM,YAAW,EAAG,MAAM,GAAG,EAAE,KAAK,GAAG,CAAC,EACjEP,EAAK,KAAK,CACT,MAAAO,EACA,QAASL,EAAS,IAAMT,CAAO,EAC/B,MAAOS,EAAS,IAAMT,EAAQ,MAAM,CACtC,CAAE,CACF,EAEAe,EACC,IAAMnB,EAAgB,MACtB,IAAM,CACL,IAAIG,EAAU,IAAI,gBAAgB,SAAS,MAAM,EAC7CH,EAAgB,MACnBG,EAAQ,IAAI,WAAYH,EAAgB,KAAK,EAE7CG,EAAQ,OAAO,UAAU,EAE1B,QAAQ,UAAU,KAAM,GAAI,GAAG,SAAS,QAAQ,IAAIA,EAAQ,SAAQ,CAAE,EAAE,CACxE,CACF,EAEA,MAAMiB,EAAWP,EAAS,KAClB,CACN,MAAO,UACP,YAAa,mCACb,EACD,EAED,OAAAQ,EAAoBD,CAAQ"}