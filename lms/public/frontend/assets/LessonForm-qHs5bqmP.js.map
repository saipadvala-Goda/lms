{"version":3,"file":"LessonForm-qHs5bqmP.js","sources":["../../../../frontend/src/components/LessonPlugins.vue","../../../../frontend/src/pages/LessonForm.vue"],"sourcesContent":["<template>\n\t<div class=\"text-lg font-semibold\">\n\t\t{{ __('Components') }}\n\t</div>\n\t<div class=\"mt-5 space-y-4\">\n\t\t<Tooltip\n\t\t\t:text=\"\n\t\t\t\t__(\n\t\t\t\t\t'Content such as quiz, video and image will be added in the editor you select.'\n\t\t\t\t)\n\t\t\t\"\n\t\t\tplacement=\"bottom\"\n\t\t>\n\t\t\t<div class=\"\">\n\t\t\t\t<div class=\"text-xs text-gray-600 mb-1\">\n\t\t\t\t\t{{ __('Select an Editor') }}\n\t\t\t\t</div>\n\t\t\t\t<Select v-model=\"currentEditor\" :options=\"getEditorOptions()\" />\n\t\t\t</div>\n\t\t</Tooltip>\n\t\t<div class=\"flex\">\n\t\t\t<Link\n\t\t\t\t:value=\"quiz\"\n\t\t\t\tclass=\"flex-1\"\n\t\t\t\tdoctype=\"LMS Quiz\"\n\t\t\t\t:label=\"__('Add an existing quiz')\"\n\t\t\t\t@change=\"(option) => addQuiz(option)\"\n\t\t\t/>\n\t\t\t<router-link\n\t\t\t\t:to=\"{\n\t\t\t\t\tname: 'QuizCreation',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tquizID: 'new',\n\t\t\t\t\t},\n\t\t\t\t}\"\n\t\t\t\tclass=\"self-end ml-2\"\n\t\t\t>\n\t\t\t\t<Button>\n\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t<Plus class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t</template>\n\t\t\t\t</Button>\n\t\t\t</router-link>\n\t\t</div>\n\t\t<div class=\"\">\n\t\t\t<div class=\"text-xs text-gray-600 mb-1\">\n\t\t\t\t{{ __('Add an image, video, pdf or audio.') }}\n\t\t\t</div>\n\t\t\t<div class=\"flex\">\n\t\t\t\t<FileUploader\n\t\t\t\t\tv-if=\"!file\"\n\t\t\t\t\t:fileTypes=\"['image/*', 'video/*', 'audio/*', '.pdf']\"\n\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t@success=\"(data) => addFile(data)\"\n\t\t\t\t>\n\t\t\t\t\t<template v-slot=\"{ file, progress, uploading, openFileSelector }\">\n\t\t\t\t\t\t<div class=\"\">\n\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\tuploading\n\t\t\t\t\t\t\t\t\t\t? __('Uploading {0}%').format(progress)\n\t\t\t\t\t\t\t\t\t\t: __('Upload a File')\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</FileUploader>\n\t\t\t\t<div v-else class=\"\">\n\t\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t\t<div class=\"border rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t<FileText class=\"h-4 w-4 stroke-1.5 text-gray-700\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"flex flex-col\">\n\t\t\t\t\t\t\t<span class=\"text-xs\">\n\t\t\t\t\t\t\t\t{{ file.file_name }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"\">\n\t\t\t<div class=\"text-xs text-gray-600 mb-1\">\n\t\t\t\t{{\n\t\t\t\t\t__(\n\t\t\t\t\t\t'To add a YouTube video, paste the URL of the video in the editor.'\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<YouTubeExplanation>\n\t\t\t\t<template v-slot=\"{ togglePopover }\">\n\t\t\t\t\t<div\n\t\t\t\t\t\t@click=\"togglePopover()\"\n\t\t\t\t\t\tclass=\"flex items-center text-sm underline cursor-pointer\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Info class=\"w-3 h-3 stroke-1.5 text-gray-700 mr-1\" />\n\t\t\t\t\t\t{{ __('Learn More') }}\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</YouTubeExplanation>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport Link from '@/components/Controls/Link.vue'\nimport { FileUploader, Button, Select, Tooltip } from 'frappe-ui'\nimport { Plus, FileText, Info } from 'lucide-vue-next'\nimport { ref, watch } from 'vue'\nimport YouTubeExplanation from '@/components/Modals/YouTubeExplanation.vue'\n\nconst quiz = ref(null)\nconst file = ref(null)\nconst lessonEditor = ref(null)\nconst instructorEditor = ref(null)\nconst currentEditor = ref('Lesson Content')\n\nconst props = defineProps({\n\teditor: {\n\t\trequired: true,\n\t},\n\tnotesEditor: {\n\t\trequired: true,\n\t},\n})\n\nconst addQuiz = (value) => {\n\tgetCurrentEditor().caret.setToLastBlock('end', 0)\n\tif (value) {\n\t\tgetCurrentEditor().blocks.insert('quiz', {\n\t\t\tquiz: value,\n\t\t})\n\t\tquiz.value = null\n\t}\n}\n\nconst addFile = (data) => {\n\tgetCurrentEditor().caret.setToLastBlock('end', 0)\n\tgetCurrentEditor().blocks.insert('upload', data)\n}\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png', 'mp4', 'mov', 'mp3', 'pdf'].includes(extension)) {\n\t\treturn 'Only image and video files are allowed.'\n\t}\n}\n\nconst getEditorOptions = () => {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Lesson Content',\n\t\t\tvalue: 'Lesson Content',\n\t\t},\n\t\t{\n\t\t\tlabel: 'Instructor Content',\n\t\t\tvalue: 'Instructor Content',\n\t\t},\n\t]\n}\n\nconst getCurrentEditor = () => {\n\treturn currentEditor.value == 'Lesson Content'\n\t\t? lessonEditor.value\n\t\t: instructorEditor.value\n}\n\nwatch(\n\t() => [props.editor, props.notesEditor],\n\t([newEditor, newNotesEditor], [oldEditor, oldNotesEditor]) => {\n\t\tlessonEditor.value = newEditor\n\t\tinstructorEditor.value = newNotesEditor\n\t}\n)\n</script>\n","<template>\n\t<div class=\"\">\n\t\t<div class=\"grid md:grid-cols-[75%,25%] h-screen\">\n\t\t\t<div class=\"border-r\">\n\t\t\t\t<header\n\t\t\t\t\tclass=\"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b overflow-hidden bg-white px-3 py-2.5 sm:px-5\"\n\t\t\t\t>\n\t\t\t\t\t<Breadcrumbs class=\"text-ellipsis\" :items=\"breadcrumbs\" />\n\t\t\t\t\t<Button variant=\"solid\" @click=\"saveLesson()\" class=\"mt-3 md:mt-0\">\n\t\t\t\t\t\t{{ __('Save') }}\n\t\t\t\t\t</Button>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"py-5\">\n\t\t\t\t\t<div class=\"w-5/6 mx-auto\">\n\t\t\t\t\t\t<FormControl v-model=\"lesson.title\" label=\"Title\" class=\"mb-4\" />\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"lesson.include_in_preview\"\n\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\tlabel=\"Include in Preview\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"border-t mt-4\">\n\t\t\t\t\t\t<div class=\"w-5/6 mx-auto pt-4\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex justify-between cursor-pointer\"\n\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\t\t\topenInstructorEditor = !openInstructorEditor\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<label class=\"block font-medium text-gray-600 mb-1\">\n\t\t\t\t\t\t\t\t\t{{ __('Instructor Notes') }}\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t<ChevronRight\n\t\t\t\t\t\t\t\t\tclass=\"stroke-2 h-5 w-5 text-gray-600\"\n\t\t\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t\t\t'rotate-90 transform duration-200': openInstructorEditor,\n\t\t\t\t\t\t\t\t\t\t'duration-200': !openInstructorEditor,\n\t\t\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-show=\"openInstructorEditor\"\n\t\t\t\t\t\t\t\tid=\"instructor-notes\"\n\t\t\t\t\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100 prose-sm max-w-none !whitespace-normal py-3\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"border-t mt-4\">\n\t\t\t\t\t\t<div class=\"w-5/6 mx-auto pt-4\">\n\t\t\t\t\t\t\t<label class=\"block font-medium text-gray-600 mb-1\">\n\t\t\t\t\t\t\t\t{{ __('Content') }}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tid=\"content\"\n\t\t\t\t\t\t\t\tclass=\"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100 prose-sm max-w-none !whitespace-normal py-3\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"\">\n\t\t\t\t<div class=\"sticky top-0 p-5\">\n\t\t\t\t\t<LessonPlugins :editor=\"editor\" :notesEditor=\"instructorEditor\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { Breadcrumbs, FormControl, createResource, Button } from 'frappe-ui'\nimport {\n\tcomputed,\n\treactive,\n\tonMounted,\n\tinject,\n\tref,\n\tonBeforeUnmount,\n} from 'vue'\nimport EditorJS from '@editorjs/editorjs'\nimport LessonPlugins from '@/components/LessonPlugins.vue'\nimport { ChevronRight } from 'lucide-vue-next'\nimport { updateDocumentTitle, createToast, getEditorTools } from '@/utils'\nimport { capture } from '@/telemetry'\n\nconst editor = ref(null)\nconst instructorEditor = ref(null)\nconst user = inject('$user')\nconst openInstructorEditor = ref(false)\nlet autoSaveInterval\n\nconst props = defineProps({\n\tcourseName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tchapterNumber: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\tlessonNumber: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nonMounted(() => {\n\tif (!user.data?.is_moderator && !user.data?.is_instructor) {\n\t\twindow.location.href = '/login'\n\t}\n\tcapture('lesson_form_opened')\n\teditor.value = renderEditor('content')\n\tinstructorEditor.value = renderEditor('instructor-notes')\n})\n\nconst renderEditor = (holder) => {\n\treturn new EditorJS({\n\t\tholder: holder,\n\t\ttools: getEditorTools(),\n\t\tautofocus: true,\n\t})\n}\n\nconst lesson = reactive({\n\ttitle: '',\n\tinclude_in_preview: false,\n\tbody: 'Test',\n\tinstructor_notes: '',\n\tcontent: '',\n})\n\nconst lessonDetails = createResource({\n\turl: 'lms.lms.utils.get_lesson_creation_details',\n\tparams: {\n\t\tcourse: props.courseName,\n\t\tchapter: props.chapterNumber,\n\t\tlesson: props.lessonNumber,\n\t},\n\tauto: true,\n\tonSuccess(data) {\n\t\tif (data.lesson) {\n\t\t\tObject.keys(data.lesson).forEach((key) => {\n\t\t\t\tlesson[key] = data.lesson[key]\n\t\t\t})\n\t\t\tlesson.include_in_preview = data.include_in_preview ? true : false\n\t\t\taddLessonContent(data)\n\t\t\taddInstructorNotes(data)\n\t\t\tenableAutoSave()\n\t\t}\n\t},\n})\n\nconst addLessonContent = (data) => {\n\teditor.value.isReady.then(() => {\n\t\tif (data.lesson.content) {\n\t\t\teditor.value.render(JSON.parse(data.lesson.content))\n\t\t} else if (data.lesson.body) {\n\t\t\tlet blocks = convertToJSON(data.lesson)\n\t\t\teditor.value.render({\n\t\t\t\tblocks: blocks,\n\t\t\t})\n\t\t}\n\t})\n}\n\nconst addInstructorNotes = (data) => {\n\tinstructorEditor.value.isReady.then(() => {\n\t\tif (data.lesson.instructor_content) {\n\t\t\tinstructorEditor.value.render(JSON.parse(data.lesson.instructor_content))\n\t\t} else if (data.lesson.instructor_notes) {\n\t\t\tlet blocks = convertToJSON(data.lesson)\n\t\t\tinstructorEditor.value.render({\n\t\t\t\tblocks: blocks,\n\t\t\t})\n\t\t}\n\t})\n}\n\nconst enableAutoSave = () => {\n\tautoSaveInterval = setInterval(() => {\n\t\tsaveLesson()\n\t}, 5000)\n}\n\nonBeforeUnmount(() => {\n\tclearInterval(autoSaveInterval)\n})\n\nconst newLessonResource = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Course Lesson',\n\t\t\t\tcourse: props.courseName,\n\t\t\t\tchapter: lessonDetails.data?.chapter.name,\n\t\t\t\t...lesson,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst editLesson = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Course Lesson',\n\t\t\tname: values.lesson,\n\t\t\tfieldname: lesson,\n\t\t}\n\t},\n})\n\nconst lessonReference = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Lesson Reference',\n\t\t\t\tparent: lessonDetails.data?.chapter.name,\n\t\t\t\tparenttype: 'Course Chapter',\n\t\t\t\tparentfield: 'lessons',\n\t\t\t\tlesson: values.lesson,\n\t\t\t\tidx: props.lessonNumber,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst convertToJSON = (lessonData) => {\n\tlet blocks = []\n\tif (lessonData.youtube) {\n\t\tlet youtubeID = lessonData.youtube.split('/').pop()\n\t\tblocks.push({\n\t\t\ttype: 'embed',\n\t\t\tdata: {\n\t\t\t\tservice: 'youtube',\n\t\t\t\tembed: `https://www.youtube.com/embed/${youtubeID}`,\n\t\t\t},\n\t\t})\n\t}\n\tlessonData.body.split('\\n').forEach((block) => {\n\t\tif (block.includes('{{ YouTubeVideo')) {\n\t\t\tlet youtubeID = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tif (!youtubeID.includes('https://'))\n\t\t\t\tyoutubeID = `https://www.youtube.com/embed/${youtubeID}`\n\t\t\tblocks.push({\n\t\t\t\ttype: 'embed',\n\t\t\t\tdata: {\n\t\t\t\t\tservice: 'youtube',\n\t\t\t\t\tembed: youtubeID,\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Quiz')) {\n\t\t\tlet quiz = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'quiz',\n\t\t\t\tdata: {\n\t\t\t\t\tquiz: quiz,\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Video')) {\n\t\t\tlet video = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: video,\n\t\t\t\t\tfile_type: 'video',\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Audio')) {\n\t\t\tlet audio = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: audio,\n\t\t\t\t\tfile_type: 'audio',\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ PDF')) {\n\t\t\tlet pdf = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: pdf,\n\t\t\t\t\tfile_type: 'pdf',\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('{{ Embed')) {\n\t\t\tlet embed = block.match(/\\([\"']([^\"']+?)[\"']\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'embed',\n\t\t\t\tdata: {\n\t\t\t\t\tservice: embed.split('|||')[0],\n\t\t\t\t\tembed: embed.split('|||')[1],\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('![]')) {\n\t\t\tlet image = block.match(/\\((.*?)\\)/)[1]\n\t\t\tblocks.push({\n\t\t\t\ttype: 'upload',\n\t\t\t\tdata: {\n\t\t\t\t\tfile_url: image,\n\t\t\t\t\tfile_type: 'image',\n\t\t\t\t},\n\t\t\t})\n\t\t} else if (block.includes('#')) {\n\t\t\tlet level = (block.match(/#/g) || []).length\n\t\t\tblocks.push({\n\t\t\t\ttype: 'header',\n\t\t\t\tdata: {\n\t\t\t\t\ttext: block.replace(/#/g, '').trim(),\n\t\t\t\t\tlevel: level,\n\t\t\t\t},\n\t\t\t})\n\t\t} else {\n\t\t\tblocks.push({\n\t\t\t\ttype: 'paragraph',\n\t\t\t\tdata: {\n\t\t\t\t\ttext: block,\n\t\t\t\t},\n\t\t\t})\n\t\t}\n\t})\n\n\tif (lessonData.quizId) {\n\t\tblocks.push({\n\t\t\ttype: 'quiz',\n\t\t\tdata: {\n\t\t\t\tquiz: lessonData.quizId,\n\t\t\t},\n\t\t})\n\t}\n\n\treturn blocks\n}\n\nconst saveLesson = () => {\n\teditor.value.save().then((outputData) => {\n\t\tlesson.content = JSON.stringify(outputData)\n\t\tinstructorEditor.value.save().then((outputData) => {\n\t\t\tlesson.instructor_content = JSON.stringify(outputData)\n\t\t\tif (lessonDetails.data?.lesson) {\n\t\t\t\teditCurrentLesson()\n\t\t\t} else {\n\t\t\t\tcreateNewLesson()\n\t\t\t}\n\t\t})\n\t})\n}\n\nconst createNewLesson = () => {\n\tnewLessonResource.submit(\n\t\t{},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\treturn validateLesson()\n\t\t\t},\n\t\t\tonSuccess(data) {\n\t\t\t\tlessonReference.submit(\n\t\t\t\t\t{ lesson: data.name },\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\t\tcapture('lesson_created')\n\t\t\t\t\t\t\tshowToast('Success', 'Lesson created successfully', 'check')\n\t\t\t\t\t\t\tlessonDetails.reload()\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast('Error', err.message, 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editCurrentLesson = () => {\n\teditLesson.submit(\n\t\t{\n\t\t\tlesson: lessonDetails.data.lesson.name,\n\t\t},\n\t\t{\n\t\t\tvalidate() {\n\t\t\t\treturn validateLesson()\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast('Error', err.message, 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst validateLesson = () => {\n\tif (!lesson.title) {\n\t\treturn 'Title is required'\n\t}\n\tif (!lesson.content) {\n\t\treturn 'Content is required'\n\t}\n}\n\nconst showToast = (title, text, icon) => {\n\tcreateToast({\n\t\ttitle: title,\n\t\ttext: text,\n\t\ticon: icon,\n\t\ticonClasses:\n\t\t\ticon == 'check'\n\t\t\t\t? 'bg-green-600 text-white rounded-md p-px'\n\t\t\t\t: 'bg-red-600 text-white rounded-md p-px',\n\t\tposition: icon == 'check' ? 'bottom-right' : 'top-center',\n\t\ttimeout: icon == 'check' ? 5 : 10,\n\t})\n}\n\nconst breadcrumbs = computed(() => {\n\tlet crumbs = [\n\t\t{\n\t\t\tlabel: 'Courses',\n\t\t\troute: { name: 'Courses' },\n\t\t},\n\t\t{\n\t\t\tlabel: lessonDetails.data?.course_title,\n\t\t\troute: { name: 'CourseDetail', params: { courseName: props.courseName } },\n\t\t},\n\t]\n\n\tif (lessonDetails?.data?.lesson) {\n\t\tcrumbs.push({\n\t\t\tlabel: lessonDetails.data.lesson.title,\n\t\t\troute: {\n\t\t\t\tname: 'Lesson',\n\t\t\t\tparams: {\n\t\t\t\t\tcourseName: props.courseName,\n\t\t\t\t\tchapterNumber: props.chapterNumber,\n\t\t\t\t\tlessonNumber: props.lessonNumber,\n\t\t\t\t},\n\t\t\t},\n\t\t})\n\t}\n\tcrumbs.push({\n\t\tlabel: lessonDetails?.data?.lesson ? 'Edit Lesson' : 'Create Lesson',\n\t\troute: {\n\t\t\tname: 'LessonForm',\n\t\t\tparams: {\n\t\t\t\tcourseName: props.courseName,\n\t\t\t\tchapterNumber: props.chapterNumber,\n\t\t\t\tlessonNumber: props.lessonNumber,\n\t\t\t},\n\t\t},\n\t})\n\treturn crumbs\n})\n\nconst pageMeta = computed(() => {\n\treturn {\n\t\ttitle: 'Lesson Editor',\n\t\tdescription: 'Create and edit lessons for your course',\n\t}\n})\n\nupdateDocumentTitle(pageMeta)\n</script>\n<style>\n.embed-tool__caption,\n.cdx-simple-image__caption {\n\tdisplay: none;\n}\n\n.ce-block__content {\n\tmax-width: none;\n}\n\n.ce-toolbar__content {\n\tmax-width: none;\n}\n\n.codeBoxHolder {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: flex-start;\n}\n\n.codeBoxTextArea {\n\twidth: 100%;\n\tmin-height: 30px;\n\tpadding: 10px;\n\tborder-radius: 2px 2px 2px 0;\n\tborder: none !important;\n\toutline: none !important;\n\tfont: 14px monospace;\n}\n\n.codeBoxSelectDiv {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: flex-start;\n\tposition: relative;\n}\n\n.codeBoxSelectInput {\n\tborder-radius: 0 0 20px 2px;\n\tpadding: 2px 26px;\n\tpadding-top: 0;\n\tpadding-right: 0;\n\ttext-align: left;\n\tcursor: pointer;\n\tborder: none !important;\n\toutline: none !important;\n}\n\n.codeBoxSelectDropIcon {\n\tposition: absolute !important;\n\tleft: 10px !important;\n\tbottom: 0 !important;\n\twidth: unset !important;\n\theight: unset !important;\n\tfont-size: 16px !important;\n}\n\n.codeBoxSelectPreview {\n\tdisplay: none;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: flex-start;\n\tborder-radius: 2px;\n\tbox-shadow: 0 3px 15px -3px rgba(13, 20, 33, 0.13);\n\tposition: absolute;\n\ttop: 100%;\n\tmargin: 5px 0;\n\tmax-height: 30vh;\n\toverflow-x: hidden;\n\toverflow-y: auto;\n\tz-index: 10000;\n}\n\n.codeBoxSelectItem {\n\twidth: 100%;\n\tpadding: 5px 20px;\n\tmargin: 0;\n\tcursor: pointer;\n}\n\n.codeBoxSelectItem:hover {\n\topacity: 0.7;\n}\n\n.codeBoxSelectedItem {\n\tbackground-color: lightblue !important;\n}\n\n.codeBoxShow {\n\tdisplay: flex !important;\n}\n\n.dark {\n\tcolor: #abb2bf;\n\tbackground-color: #282c34;\n}\n\n.light {\n\tcolor: #383a42;\n\tbackground-color: #fafafa;\n}\n</style>\n"],"names":["quiz","ref","file","lessonEditor","instructorEditor","currentEditor","props","__props","addQuiz","value","getCurrentEditor","addFile","data","validateFile","extension","getEditorOptions","watch","newEditor","newNotesEditor","oldEditor","oldNotesEditor","editor","user","inject","openInstructorEditor","autoSaveInterval","onMounted","_a","_b","capture","renderEditor","holder","EditorJS","getEditorTools","lesson","reactive","lessonDetails","createResource","key","addLessonContent","addInstructorNotes","enableAutoSave","blocks","convertToJSON","saveLesson","onBeforeUnmount","newLessonResource","values","__spreadValues","editLesson","lessonReference","lessonData","youtubeID","block","video","audio","pdf","embed","image","level","outputData","editCurrentLesson","createNewLesson","validateLesson","showToast","err","title","text","icon","createToast","breadcrumbs","computed","crumbs","_c","pageMeta","updateDocumentTitle"],"mappings":"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"}