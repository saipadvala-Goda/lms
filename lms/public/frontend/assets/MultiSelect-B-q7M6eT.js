import{ae as j,af as q,r as c,j as b,a7 as I,k as T,x as d,y as h,F as M,J as w,M as U,C as o,K as F,L as S,A as K,B as f,H as m,I as r,aR as $,G as B,N as A,P as G,a2 as H,O as J,a3 as Q,a4 as X,a6 as W,n as Y,Q as Z}from"./frappe-ui-CfOnYHud.js";import{X as R}from"./index-5_0ocoxz.js";const ee={class:"grid grid-cols-3 gap-1"},te={class:""},se={class:"mt-1 rounded-lg bg-white py-1 text-base shadow-2xl"},ae={class:"flex flex-col gap-1 p-1"},le={class:"text-base font-medium"},oe={class:"text-sm text-gray-600"},ne={__name:"MultiSelect",props:j({label:{type:String},size:{type:String,default:"sm"},doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},validate:{type:Function,default:null},errorMessage:{type:Function,default:n=>`${n} is an Invalid value`}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n,{expose:O}){const u=n,l=q(n,"modelValue"),p=c([]),_=c(null),g=c(null),i=c(""),v=c(""),y=c(!1),k=b({get:()=>i.value||"",set:e=>{i.value="",e&&(y.value=!1),e!=null&&e.value&&D(e.value)}});I(i,e=>{e=e||"",v.value!==e&&(v.value=e,z(e))},{debounce:300,immediate:!0});const x=T({url:"frappe.desk.search.search_link",method:"POST",cache:[v.value,u.doctype],params:{txt:v.value,doctype:u.doctype}}),N=b(()=>x.data||[]);function z(e){x.update({params:{txt:e,doctype:u.doctype}}),x.reload()}const D=e=>{g.value=null,e&&(e.split(",").forEach(t=>{var a;if(t=t.trim(),t&&!((a=l.value)!=null&&a.includes(t))){if(t&&u.validate&&!u.validate(t)){g.value=u.errorMessage(t);return}l.value?l.value.push(t):l.value=[t],t=t.replace(t,"")}}),!g.value&&(e=""))},E=e=>{l.value=l.value.filter(s=>s!==e)},V=()=>{var s;if(i.value)return;let e=(s=p.value[p.value.length-1])==null?void 0:s.$el;document.activeElement===e?(l.value.pop(),Y(()=>{l.value.length?(e=p.value[p.value.length-1].$el,e==null||e.focus()):C()})):e==null||e.focus()};function C(){_.value.$el.focus()}O({setFocus:C});const L=b(()=>[{sm:"text-xs",md:"text-base"}[u.size||"sm"],"text-gray-600"]);return(e,s)=>(d(),h("div",null,[n.label?(d(),h("label",{key:0,class:M(["block mb-1",L.value])},w(n.label),3)):U("",!0),o("div",ee,[(d(!0),h(F,null,S(l.value,t=>(d(),K(r(A),{ref_for:!0,ref_key:"emails",ref:p,key:t,label:t,theme:"gray",variant:"subtle",class:"rounded-md",onKeydownCapture:$(B(V,["stop"]),["delete"])},{suffix:f(()=>[m(r(R),{onClick:a=>E(t),class:"h-4 w-4 stroke-1.5"},null,8,["onClick"])]),_:2},1032,["label","onKeydownCapture"]))),128)),o("div",te,[m(r(W),{modelValue:k.value,"onUpdate:modelValue":s[2]||(s[2]=t=>k.value=t),nullable:""},{default:f(()=>[m(r(G),{class:"w-full",show:y.value,"onUpdate:show":s[1]||(s[1]=t=>y.value=t)},{target:f(({togglePopover:t})=>[m(r(H),{ref_key:"search",ref:_,class:"search-input form-input w-full focus-visible:!ring-0",type:"text",value:i.value,onChange:s[0]||(s[0]=a=>{i.value=a.target.value,y.value=!0}),autocomplete:"off",onFocus:()=>t(),onKeydownCapture:$(B(V,["stop"]),["delete"])},null,8,["value","onFocus","onKeydownCapture"])]),body:f(({isOpen:t})=>[J(o("div",null,[o("div",se,[m(r(Q),{class:"my-1 max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:f(()=>[(d(!0),h(F,null,S(N.value,a=>(d(),K(r(X),{key:a.value,value:a},{default:f(({active:P})=>[o("li",{class:M(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-gray-100":P}])},[o("div",ae,[o("div",le,w(a.description),1),o("div",oe,w(a.value),1)])],2)]),_:2},1032,["value"]))),128))]),_:1})])],512),[[Z,t]])]),_:1},8,["show"])]),_:1},8,["modelValue"])])])]))}};export{ne as _};
//# sourceMappingURL=MultiSelect-B-q7M6eT.js.map
