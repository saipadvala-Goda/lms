import{ae as B,r as N,af as P,d as $,k as j,x as d,A as C,B as p,C as a,J as i,y as _,H as l,I as e,N as w,a9 as S,aN as F,D as Y,j as z,am as H,M as k,b as R,av as E}from"./frappe-ui-CfOnYHud.js";import{D as q,H as I,c as U,u as O,Q,R as W,W as Z,Y as G,Z as K,$ as X,a0 as ee}from"./index-5_0ocoxz.js";const te={class:"flex flex-col gap-4"},ae={key:0},se={class:""},oe={key:1,class:"flex items-center"},le={class:"border rounded-md p-2 mr-2"},ie={class:"flex flex-col"},ne={class:"text-sm text-gray-500 mt-1"},re={__name:"JobApplicationModal",props:B({job:{type:String,required:!0}},{modelValue:{},modelModifiers:{},application:{},applicationModifiers:{}}),emits:["update:modelValue","update:application"],setup(b){const r=N(null),x=P(b,"modelValue"),f=$("$user"),y=P(b,"application"),o=b,u=c=>{if(c.name.split(".").pop().toLowerCase()!="pdf")return"Only PDF file is allowed"},v=j({url:"frappe.client.insert",makeParams(c){var n,t;return{doc:{doctype:"LMS Job Application",user:(n=f.data)==null?void 0:n.name,resume:(t=r.value)==null?void 0:t.file_name,job:o.job}}}}),M=c=>{v.submit({},{validate(){if(!r.value)return"Please upload your resume"},onSuccess(){U({title:"Success",text:"Your application has been submitted",icon:"check",iconClasses:"bg-green-600 text-white rounded-md p-px"}),y.value.reload(),c()},onError(n){var t;U({title:"Error",text:((t=n.messages)==null?void 0:t[0])||n,icon:"x",iconClasses:"bg-red-600 text-white rounded-md p-px",position:"top-center",timeout:10})}})};return(c,n)=>(d(),C(e(Y),{modelValue:x.value,"onUpdate:modelValue":n[1]||(n[1]=t=>x.value=t),class:"text-base",options:{title:c.__("Apply for this job"),size:"lg",actions:[{label:"Submit",variant:"solid",onClick:t=>{M(t)}}]}},{"body-content":p(()=>[a("div",te,[a("p",null,i(c.__("Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.")),1),r.value?(d(),_("div",oe,[a("div",le,[l(e(q),{class:"h-5 w-5 stroke-1.5 text-gray-700"})]),a("div",ie,[a("span",null,i(r.value.file_name),1),a("span",ne,i(e(I)(r.value.file_size)),1)])])):(d(),_("div",ae,[l(e(F),{fileTypes:[".pdf"],validateFile:u,onSuccess:n[0]||(n[0]=t=>{r.value=t})},{default:p(({file:t,progress:s,uploading:m,openFileSelector:g})=>[a("div",se,[l(e(w),{onClick:g,loading:m},{default:p(()=>[S(i(m?`Uploading ${s}%`:"Upload your resume"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]))])]),_:1},8,["modelValue","options"]))}},de={class:""},ce={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5"},pe={key:0,class:"flex"},ue={key:1},me={key:0,class:"max-w-3xl mx-auto"},_e={class:"p-4"},be={class:"flex mb-10"},fe=["src","alt"],ve={class:"text-2xl font-semibold mb-4"},he={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-10 gap-y-2 md:gap-y-4"},xe={class:"flex items-center space-x-2"},ye={class:"flex items-center space-x-2"},ge={class:"flex items-center space-x-2"},ke={class:"flex items-center space-x-2"},je={key:0,class:"flex items-center space-x-2"},we=["innerHTML"],Ce={__name:"JobDetail",props:{job:{type:String,required:!0}},setup(b){const r=$("$user"),x=$("$dayjs"),f=N(!1),y=b,o=j({url:"lms.lms.api.get_job_details",params:{job:y.job},cache:["job",y.job],auto:!0,onSuccess:t=>{var s;(s=r.data)!=null&&s.name&&u.submit(),v.submit()}}),u=j({url:"frappe.client.get_list",makeParams(t){var s,m;return{doctype:"LMS Job Application",filters:{job:(s=o.data)==null?void 0:s.name,user:(m=r.data)==null?void 0:m.name}}}}),v=j({url:"frappe.client.get_count",makeParams(t){var s;return{doctype:"LMS Job Application",filters:{job:(s=o.data)==null?void 0:s.name}}}}),M=()=>{f.value=!0},c=t=>{window.location.href=`/login?redirect-to=/job-openings/${t}`},n=z(()=>{var t,s;return{title:(t=o.data)==null?void 0:t.job_title,description:(s=o.data)==null?void 0:s.description}});return O(n),(t,s)=>{var g,V,A,D,J,T;const m=H("router-link");return d(),_("div",de,[a("header",ce,[l(e(E),{class:"h-7",items:[{label:t.__("Jobs"),route:{name:"Jobs"}},{label:(g=e(o).data)==null?void 0:g.job_title,route:{name:"JobDetail",params:{job:(V=e(o).data)==null?void 0:V.name}}}]},null,8,["items"]),(A=e(r).data)!=null&&A.name?(d(),_("div",pe,[e(r).data.name==((D=e(o).data)==null?void 0:D.owner)?(d(),C(m,{key:0,to:{name:"JobCreation",params:{jobName:(J=e(o).data)==null?void 0:J.name}}},{default:p(()=>[l(e(w),{class:"mr-2"},{prefix:p(()=>[l(e(Q),{class:"h-4 w-4 stroke-1.5"})]),default:p(()=>[S(" "+i(t.__("Edit")),1)]),_:1})]),_:1},8,["to"])):k("",!0),(T=e(u).data)!=null&&T.length?k("",!0):(d(),C(e(w),{key:1,variant:"solid",onClick:s[0]||(s[0]=h=>M())},{prefix:p(()=>[l(e(W),{class:"h-4 w-4"})]),default:p(()=>[S(" "+i(t.__("Apply")),1)]),_:1}))])):(d(),_("div",ue,[l(e(w),{onClick:s[1]||(s[1]=h=>{var L;return c((L=e(o).data)==null?void 0:L.name)})},{default:p(()=>[a("span",null,i(t.__("Login to apply")),1)]),_:1})]))]),e(o).data?(d(),_("div",me,[a("div",_e,[a("div",be,[a("img",{src:e(o).data.company_logo,class:"w-16 h-16 rounded-lg object-contain mr-4",alt:e(o).data.company_name},null,8,fe),a("div",null,[a("div",ve,i(e(o).data.job_title),1),a("div",he,[a("div",xe,[l(e(Z),{class:"h-4 w-4 stroke-1.5"}),a("span",null,i(e(o).data.company_name),1)]),a("div",ye,[l(e(G),{class:"h-4 w-4 stroke-1.5"}),a("span",null,i(e(o).data.location),1)]),a("div",ge,[l(e(K),{class:"h-4 w-4 stroke-1.5"}),a("span",null,i(e(o).data.type),1)]),a("div",ke,[l(e(X),{class:"h-4 w-4 stroke-1.5"}),a("span",null,i(e(x)(e(o).data.creation).format("DD MMM YYYY")),1)]),e(v).data?(d(),_("div",je,[l(e(ee),{class:"h-4 w-4 stroke-1.5"}),a("span",null,i(e(v).data)+" "+i(t.__("applications received")),1)])):k("",!0)])])]),a("p",{innerHTML:e(o).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-gray-300 prose-th:border-gray-300 prose-td:relative prose-th:relative prose-th:bg-gray-100 prose-sm max-w-none !whitespace-normal mt-6"},null,8,we)]),l(re,{modelValue:f.value,"onUpdate:modelValue":s[2]||(s[2]=h=>f.value=h),application:e(u),"onUpdate:application":s[3]||(s[3]=h=>R(u)?u.value=h:null),job:e(o).data.name},null,8,["modelValue","application","job"])])):k("",!0)])}}};export{Ce as default};
//# sourceMappingURL=JobDetail-Op9n4xAQ.js.map
