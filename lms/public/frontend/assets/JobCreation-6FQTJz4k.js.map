{"version":3,"file":"JobCreation-6FQTJz4k.js","sources":["../../../../frontend/src/pages/JobCreation.vue"],"sourcesContent":["<template>\n\t<div class=\"\">\n\t\t<header\n\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-3 py-2.5 sm:px-5\"\n\t\t>\n\t\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t\t<Button variant=\"solid\" @click=\"saveJob()\">\n\t\t\t\t{{ __('Save') }}\n\t\t\t</Button>\n\t\t</header>\n\t\t<div class=\"py-5\">\n\t\t\t<div class=\"container border-b mb-4 pb-4\">\n\t\t\t\t<div class=\"text-lg font-semibold mb-4\">\n\t\t\t\t\t{{ __('Job Details') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"job.job_title\"\n\t\t\t\t\t\t\t:label=\"__('Title')\"\n\t\t\t\t\t\t\tclass=\"mb-4\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl v-model=\"job.location\" :label=\"__('Location')\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"job.type\"\n\t\t\t\t\t\t\t:label=\"__('Type')\"\n\t\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t\t:options=\"jobTypes\"\n\t\t\t\t\t\t\tclass=\"mb-4\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"job.status\"\n\t\t\t\t\t\t\t:label=\"__('Status')\"\n\t\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t\t:options=\"jobStatuses\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mt-4\">\n\t\t\t\t\t<label class=\"block text-gray-600 text-xs mb-1\">\n\t\t\t\t\t\t{{ __('Description') }}\n\t\t\t\t\t</label>\n\t\t\t\t\t<TextEditor\n\t\t\t\t\t\t:content=\"job.description\"\n\t\t\t\t\t\t@change=\"(val) => (job.description = val)\"\n\t\t\t\t\t\t:editable=\"true\"\n\t\t\t\t\t\t:fixedMenu=\"true\"\n\t\t\t\t\t\teditorClass=\"prose-sm max-w-none border-b border-x bg-gray-100 rounded-b-md py-1 px-2 min-h-[7rem] mb-4\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"container mb-4 pb-4\">\n\t\t\t\t<div class=\"text-lg font-semibold mb-4\">\n\t\t\t\t\t{{ __('Company Details') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"grid grid-cols-2 gap-4\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"job.company_name\"\n\t\t\t\t\t\t\t:label=\"__('Company Name')\"\n\t\t\t\t\t\t\tclass=\"mb-4\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"job.company_website\"\n\t\t\t\t\t\t\t:label=\"__('Company Website')\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tv-model=\"job.company_email_address\"\n\t\t\t\t\t\t\t:label=\"__('Company Email Address')\"\n\t\t\t\t\t\t\tclass=\"mb-4\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<label class=\"block text-gray-600 text-xs mb-1 mt-4\">\n\t\t\t\t\t\t\t{{ __('Company Logo') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t\t<FileUploader\n\t\t\t\t\t\t\tv-if=\"!job.image\"\n\t\t\t\t\t\t\t:fileTypes=\"['image/*']\"\n\t\t\t\t\t\t\t:validateFile=\"validateFile\"\n\t\t\t\t\t\t\t@success=\"(file) => saveImage(file)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<template\n\t\t\t\t\t\t\t\tv-slot=\"{ file, progress, uploading, openFileSelector }\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div class=\"mb-4\">\n\t\t\t\t\t\t\t\t\t<Button @click=\"openFileSelector\" :loading=\"uploading\">\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tuploading ? `Uploading ${progress}%` : 'Upload an image'\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</FileUploader>\n\t\t\t\t\t\t<div v-else class=\"\">\n\t\t\t\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t\t\t\t<div class=\"border rounded-md p-2 mr-2\">\n\t\t\t\t\t\t\t\t\t<FileText class=\"h-5 w-5 stroke-1.5 text-gray-700\" />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"flex flex-col\">\n\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t{{ job.image.file_name }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<span class=\"text-sm text-gray-500 mt-1\">\n\t\t\t\t\t\t\t\t\t\t{{ getFileSize(job.image.file_size) }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<X\n\t\t\t\t\t\t\t\t\t@click=\"removeImage()\"\n\t\t\t\t\t\t\t\t\tclass=\"bg-gray-200 rounded-md cursor-pointer stroke-1.5 w-5 h-5 p-1 ml-4\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tFormControl,\n\tcreateResource,\n\tButton,\n\tTextEditor,\n\tFileUploader,\n} from 'frappe-ui'\nimport { computed, onMounted, reactive, inject } from 'vue'\nimport { FileText, X } from 'lucide-vue-next'\nimport { useRouter } from 'vue-router'\nimport { getFileSize, showToast } from '../utils'\n\nconst user = inject('$user')\nconst router = useRouter()\n\nconst props = defineProps({\n\tjobName: {\n\t\ttype: String,\n\t\tdefault: 'new',\n\t},\n})\n\nconst newJob = createResource({\n\turl: 'frappe.client.insert',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoc: {\n\t\t\t\tdoctype: 'Job Opportunity',\n\t\t\t\tcompany_logo: job.image.file_url,\n\t\t\t\t...job,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst updateJob = createResource({\n\turl: 'frappe.client.set_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Job Opportunity',\n\t\t\tname: props.jobName,\n\t\t\tfieldname: {\n\t\t\t\tcompany_logo: job.image.file_url,\n\t\t\t\t...job,\n\t\t\t},\n\t\t}\n\t},\n})\n\nconst jobDetail = createResource({\n\turl: 'frappe.client.get',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'Job Opportunity',\n\t\t\tname: props.jobName,\n\t\t}\n\t},\n\tonSuccess(data) {\n\t\tObject.keys(data).forEach((key) => {\n\t\t\tif (Object.hasOwn(job, key)) job[key] = data[key]\n\t\t})\n\t\tif (data.company_logo) imageResource.reload({ image: data.company_logo })\n\t},\n})\n\nconst imageResource = createResource({\n\turl: 'lms.lms.api.get_file_info',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tfile_url: values.image,\n\t\t}\n\t},\n\tauto: false,\n\tonSuccess(data) {\n\t\tjob.image = data\n\t},\n})\n\nconst job = reactive({\n\tjob_title: '',\n\tlocation: '',\n\ttype: 'Full Time',\n\tstatus: 'Open',\n\tcompany_name: '',\n\tcompany_website: '',\n\timage: null,\n\tdescription: '',\n\tcompany_email_address: '',\n})\n\nonMounted(() => {\n\tif (!user.data) window.location.href = '/login'\n\n\tif (props.jobName != 'new') jobDetail.reload()\n})\n\nconst saveJob = () => {\n\tif (jobDetail.data) {\n\t\teditJobDetails()\n\t} else {\n\t\tcreateNewJob()\n\t}\n}\n\nconst createNewJob = () => {\n\tnewJob.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\trouter.push({\n\t\t\t\t\tname: 'JobDetail',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tjob: data.name,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast('Error', err.messages?.[0] || err, 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst editJobDetails = () => {\n\tupdateJob.submit(\n\t\t{},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\trouter.push({\n\t\t\t\t\tname: 'JobDetail',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tjob: data.name,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t},\n\t\t\tonError(err) {\n\t\t\t\tshowToast('Error', err.messages?.[0] || err, 'x')\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst saveImage = (file) => {\n\tjob.image = file\n}\n\nconst removeImage = () => {\n\tjob.image = null\n}\n\nconst validateFile = (file) => {\n\tlet extension = file.name.split('.').pop().toLowerCase()\n\tif (!['jpg', 'jpeg', 'png'].includes(extension)) {\n\t\treturn 'Only image file is allowed.'\n\t}\n}\n\nconst jobTypes = computed(() => {\n\treturn [\n\t\t{ label: 'Full Time', value: 'Full Time' },\n\t\t{ label: 'Part Time', value: 'Part Time' },\n\t\t{ label: 'Contract', value: 'Contract' },\n\t\t{ label: 'Freelance', value: 'Freelance' },\n\t]\n})\n\nconst jobStatuses = computed(() => {\n\treturn [\n\t\t{ label: 'Open', value: 'Open' },\n\t\t{ label: 'Closed', value: 'Closed' },\n\t]\n})\n\nconst breadcrumbs = computed(() => {\n\tlet crumbs = [\n\t\t{\n\t\t\tlabel: 'Jobs',\n\t\t\troute: { name: 'Jobs' },\n\t\t},\n\t\t{\n\t\t\tlabel: props.jobName == 'new' ? 'New Job' : 'Edit Job',\n\t\t\troute: { name: 'JobCreation' },\n\t\t},\n\t]\n\treturn crumbs\n})\n</script>\n"],"names":["user","inject","router","useRouter","props","__props","newJob","createResource","values","__spreadValues","job","updateJob","jobDetail","data","key","imageResource","reactive","onMounted","saveJob","editJobDetails","createNewJob","err","showToast","_a","saveImage","file","removeImage","validateFile","extension","jobTypes","computed","jobStatuses","breadcrumbs"],"mappings":"6yCAuIA,MAAMA,EAAOC,EAAO,OAAO,EACrBC,EAASC,EAAW,EAEpBC,EAAQC,EAORC,EAASC,EAAe,CAC7B,IAAK,uBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,IAAKC,EAAA,CACJ,QAAS,kBACT,aAAcC,EAAI,MAAM,UACrBA,EAEJ,CACD,CACF,CAAC,EAEKC,EAAYJ,EAAe,CAChC,IAAK,0BACL,WAAWC,EAAQ,CAClB,MAAO,CACN,QAAS,kBACT,KAAMJ,EAAM,QACZ,UAAWK,EAAA,CACV,aAAcC,EAAI,MAAM,UACrBA,EAEJ,CACD,CACF,CAAC,EAEKE,EAAYL,EAAe,CAChC,IAAK,oBACL,WAAWC,EAAQ,CAClB,MAAO,CACN,QAAS,kBACT,KAAMJ,EAAM,OACZ,CACD,EACD,UAAUS,EAAM,CACf,OAAO,KAAKA,CAAI,EAAE,QAASC,GAAQ,CAC9B,OAAO,OAAOJ,EAAKI,CAAG,IAAGJ,EAAII,CAAG,EAAID,EAAKC,CAAG,EACnD,CAAG,EACGD,EAAK,cAAcE,EAAc,OAAO,CAAE,MAAOF,EAAK,aAAc,CACxE,CACF,CAAC,EAEKE,EAAgBR,EAAe,CACpC,IAAK,4BACL,WAAWC,EAAQ,CAClB,MAAO,CACN,SAAUA,EAAO,KACjB,CACD,EACD,KAAM,GACN,UAAUK,EAAM,CACfH,EAAI,MAAQG,CACZ,CACF,CAAC,EAEKH,EAAMM,EAAS,CACpB,UAAW,GACX,SAAU,GACV,KAAM,YACN,OAAQ,OACR,aAAc,GACd,gBAAiB,GACjB,MAAO,KACP,YAAa,GACb,sBAAuB,EACxB,CAAC,EAEDC,EAAU,IAAM,CACVjB,EAAK,OAAM,OAAO,SAAS,KAAO,UAEnCI,EAAM,SAAW,OAAOQ,EAAU,OAAQ,CAC/C,CAAC,EAED,MAAMM,EAAU,IAAM,CACjBN,EAAU,KACbO,EAAgB,EAEhBC,EAAc,CAEhB,EAEMA,EAAe,IAAM,CAC1Bd,EAAO,OACN,CAAE,EACF,CACC,UAAUO,EAAM,CACfX,EAAO,KAAK,CACX,KAAM,YACN,OAAQ,CACP,IAAKW,EAAK,IACV,CACN,CAAK,CACD,EACD,QAAQQ,EAAK,OACZC,EAAU,UAASC,EAAAF,EAAI,WAAJ,YAAAE,EAAe,KAAMF,EAAK,GAAG,CAChD,CACD,CACD,CACF,EAEMF,EAAiB,IAAM,CAC5BR,EAAU,OACT,CAAE,EACF,CACC,UAAUE,EAAM,CACfX,EAAO,KAAK,CACX,KAAM,YACN,OAAQ,CACP,IAAKW,EAAK,IACV,CACN,CAAK,CACD,EACD,QAAQQ,EAAK,OACZC,EAAU,UAASC,EAAAF,EAAI,WAAJ,YAAAE,EAAe,KAAMF,EAAK,GAAG,CAChD,CACD,CACD,CACF,EAEMG,EAAaC,GAAS,CAC3Bf,EAAI,MAAQe,CACb,EAEMC,EAAc,IAAM,CACzBhB,EAAI,MAAQ,IACb,EAEMiB,EAAgBF,GAAS,CAC9B,IAAIG,EAAYH,EAAK,KAAK,MAAM,GAAG,EAAE,IAAK,EAAC,YAAa,EACxD,GAAI,CAAC,CAAC,MAAO,OAAQ,KAAK,EAAE,SAASG,CAAS,EAC7C,MAAO,6BAET,EAEMC,EAAWC,EAAS,IAClB,CACN,CAAE,MAAO,YAAa,MAAO,WAAa,EAC1C,CAAE,MAAO,YAAa,MAAO,WAAa,EAC1C,CAAE,MAAO,WAAY,MAAO,UAAY,EACxC,CAAE,MAAO,YAAa,MAAO,WAAa,CAC1C,CACD,EAEKC,EAAcD,EAAS,IACrB,CACN,CAAE,MAAO,OAAQ,MAAO,MAAQ,EAChC,CAAE,MAAO,SAAU,MAAO,QAAU,CACpC,CACD,EAEKE,EAAcF,EAAS,IACf,CACZ,CACC,MAAO,OACP,MAAO,CAAE,KAAM,MAAQ,CACvB,EACD,CACC,MAAO1B,EAAM,SAAW,MAAQ,UAAY,WAC5C,MAAO,CAAE,KAAM,aAAe,CAC9B,CACD,CAED"}