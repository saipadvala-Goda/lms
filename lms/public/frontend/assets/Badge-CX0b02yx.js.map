{"version":3,"file":"Badge-CX0b02yx.js","sources":["../../../../frontend/src/pages/Badge.vue"],"sourcesContent":["<template>\n\t<div v-if=\"badge.doc\">\n\t\t<div class=\"p-5 flex flex-col items-center mt-40\">\n\t\t\t<div class=\"text-3xl font-semibold\">\n\t\t\t\t{{ badge.doc.title }}\n\t\t\t</div>\n\t\t\t<img :src=\"badge.doc.image\" :alt=\"badge.doc.title\" class=\"h-60 mt-2\" />\n\t\t\t<div class=\"text-lg\">\n\t\t\t\t{{\n\t\t\t\t\t__('This badge has been awarded to {0} on {1}.').format(\n\t\t\t\t\t\tuserName,\n\t\t\t\t\t\tdayjs(issuedOn.data?.issued_on).format('DD MMM YYYY')\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<div class=\"text-lg mt-2\">\n\t\t\t\t{{ badge.doc.description }}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport { createDocumentResource, createResource, Breadcrumbs } from 'frappe-ui'\nimport { computed, inject } from 'vue'\nimport { useRouter } from 'vue-router'\n\nconst allUsers = inject('$allUsers')\nconst dayjs = inject('$dayjs')\nconst router = useRouter()\n\nconst props = defineProps({\n\tbadgeName: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n\temail: {\n\t\ttype: String,\n\t\trequired: true,\n\t},\n})\n\nconst badge = createDocumentResource({\n\tdoctype: 'LMS Badge',\n\tname: props.badgeName,\n})\n\nconst userName = computed(() => {\n\tconst user = Object.values(allUsers.data).find(\n\t\t(user) => user.name === props.email\n\t)\n\treturn user ? user.full_name : props.email\n})\n\nconst issuedOn = createResource({\n\turl: 'frappe.client.get_value',\n\tmakeParams(values) {\n\t\treturn {\n\t\t\tdoctype: 'LMS Badge Assignment',\n\t\t\tfilters: {\n\t\t\t\tmember: props.email,\n\t\t\t\tbadge: props.badgeName,\n\t\t\t},\n\t\t\tfieldname: 'issued_on',\n\t\t}\n\t},\n\tonSuccess(data) {\n\t\tif (!data.issued_on) {\n\t\t\trouter.push({ name: 'Courses' })\n\t\t}\n\t},\n\tauto: true,\n})\n\nconst breadcrumbs = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: 'Badges',\n\t\t},\n\t\t{\n\t\t\tlabel: badge.doc.title,\n\t\t\troute: {\n\t\t\t\tname: 'Badge',\n\t\t\t\tparams: {\n\t\t\t\t\tbadge: badge.doc.name,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t]\n})\n</script>\n"],"names":["allUsers","inject","dayjs","router","useRouter","props","__props","badge","createDocumentResource","userName","computed","user","issuedOn","createResource","values","data"],"mappings":"uXA0BA,MAAMA,EAAWC,EAAO,WAAW,EAC7BC,EAAQD,EAAO,QAAQ,EACvBE,EAASC,EAAW,EAEpBC,EAAQC,EAWRC,EAAQC,EAAuB,CACpC,QAAS,YACT,KAAMH,EAAM,SACb,CAAC,EAEKI,EAAWC,EAAS,IAAM,CAC/B,MAAMC,EAAO,OAAO,OAAOX,EAAS,IAAI,EAAE,KACxCW,GAASA,EAAK,OAASN,EAAM,KAC9B,EACD,OAAOM,EAAOA,EAAK,UAAYN,EAAM,KACtC,CAAC,EAEKO,EAAWC,EAAe,CAC/B,IAAK,0BACL,WAAWC,EAAQ,CAClB,MAAO,CACN,QAAS,uBACT,QAAS,CACR,OAAQT,EAAM,MACd,MAAOA,EAAM,SACb,EACD,UAAW,WACX,CACD,EACD,UAAUU,EAAM,CACVA,EAAK,WACTZ,EAAO,KAAK,CAAE,KAAM,SAAS,CAAE,CAEhC,EACD,KAAM,EACP,CAAC,EAEmB,OAAAO,EAAS,IACrB,CACN,CACC,MAAO,QACP,EACD,CACC,MAAOH,EAAM,IAAI,MACjB,MAAO,CACN,KAAM,QACN,OAAQ,CACP,MAAOA,EAAM,IAAI,IACjB,CACD,CACD,CACD,CACD"}